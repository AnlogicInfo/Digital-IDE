<!DOCTYPE html>
<html>

<head>
    <script type="text/javascript" src="../web/elk.bundled.js"></script>
    <script type="text/javascript" src="../web/jquery-2.2.4.min.js"></script>
    <script type="text/javascript" src="../web/svg-pan-zoom.min.js"></script>
    <script type="text/javascript" src="../web/viz.js"></script>
    <script type="text/javascript" src="../web/full.render.js"></script>
    <script type="text/javascript" src="netlistsvg.bundle.js"></script>
    <script type="text/javascript" src="index.js"></script>
    <!-- <script type="text/javascript" src="test.js"></script> -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>netlist view</title>
    <link rel="stylesheet" href="netlist_viewer.css" type="text/css" />
</head>

<body>
    <p> Console of synth</p>
    <button id=Display style=width:50px;>Hide</button>
    <div class="main">
        <div id="component">
            <div style=display:flex;justify-content:space-between>
                <button id=Clean>Clean </button>
                <div>
                    <label for=synthStyle>Synth Style:</label>
                    <select id=synthStyle>
                        <option value=0>Before Behavioral Synth</option>
                        <option value=1>After Behavioral Synth</option>
                        <option value=2>After RTL Synth</option>
                    </select>
                    <button id=Run>RUN</button>
                </div>
            </div>
            <div class="output" id="output"></div>
        </div>
        <div class="container" id="netlist_container"></div>
    </div>
    <div class="toolbar">
        <div class="center-panel">
            <label class="fancy-checkbox">
                <input id="export-as-svg" name="zoom-mode" type="radio" value="fit" />
                <div class="button">Save as SVG</div>
            </label>
        </div>
    </div>
</body>

</html>

<script>
    function run() {
        let synthStyle = document.getElementById('synthStyle');
        let netlist = synth(synthStyle.value);
        showNetlist(netlist);
    }
    function clean() {
        document.getElementById("output").innerHTML = '';
        TTY.message = '';
    }
    function display() {
        let value = document.getElementById("Display").innerHTML;
        if (value == "Hide") {
            document.getElementById('component').style.visibility = 'hidden';
            document.getElementById('component').style.width = "0px";
            document.getElementById('netlist_container').style.width = "1640px";
            document.getElementById("Display").innerHTML = "Show";
        }
        else if (value == "Show") {
            document.getElementById('component').style.width = "500px";
            document.getElementById('component').style.visibility = 'visible';
            document.getElementById('netlist_container').style.width = "1240px";
            document.getElementById("Display").innerHTML = "Hide";
        }
    }

    const vscode = acquireVsCodeApi();

    function export_message(type) {
        vscode.postMessage({
            command: 'export',
            type: type,
            svg: last_svg
        });
    }

    // Handle the message inside the webview
    window.addEventListener('message', event => {
        const message = event.data;
        console.log("get the message");
        switch (message.command) {
            case 'update': refreshModel(message.synthPrjInfo); break;
        }
    });

    document.getElementById("export-as-svg").onclick = function () {
        export_message("svg");
    };

    // refreshModel(test);

    Run.onclick = run;
    Clean.onclick = clean;
    Display.onclick = display;

</script>