"use strict";

const fs = require("fs");
const fspath = require("path");

function mkdir(path) {
    if (fs.existsSync(path)) {
      return true;
    } 
    else { 
        if (mkdir(fspath.dirname(path))) {
            fs.mkdirSync(path);
            return true;
        }
    }
}
exports.mkdir = mkdir;

function deleteDir(path){
    let files = [];
    if( fs.existsSync(path) ) {  
        files = fs.readdirSync(path);   
        files.forEach(element => {
            let curPath = fspath.join(path,element).replace(/\\/g,"\/");
            if(fs.statSync(curPath).isDirectory()) { 
                deleteDir(curPath);
            } else {    
                fs.unlinkSync(curPath);    
            }
        });
        fs.rmdirSync(path); //清除文件夹
    }
}
exports.deleteDir = deleteDir;

function movedir(oldpath,newpath) {
    let folder  = fspath.basename(oldpath);
    newpath = newpath + '/' + folder;
    if (fs.existsSync(oldpath)) {
        if (fs.existsSync(newpath)) {
            deleteDir(newpath);
        }
        fs.renameSync(oldpath,newpath);
    }else{
        mkdir(newpath);	
    }
}
exports.movedir = movedir;

function readFolder(path) {
    return fs.readdirSync(path);
}
exports.readFolder = readFolder;